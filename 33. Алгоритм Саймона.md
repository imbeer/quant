> **\[Лекции/книжка]**
> - Задача — определение периода функции с использованием принципа интерференции квантовых состояний.
> - Классический алгоритм: $O(2^n)$
> - Квантовый алгоритм: $O(n)$
> 
> <u>Формулировка:</u>
> Пусть есть двоичная функция $f:(0,1)^n \rightarrow (0,1)^n$, определённая на множестве двоичных векторов $x$. Функция является периодической в том смысле, что $f(x)=f(x\oplus r)$, где $r$ — двоичный период. Путём вычисления функции найти период.

![[Pasted image 20250618033907.png]]

Определим оператор $\text{U}$ следующим образом:
$$ \hat{\text{U}}_f: \ket x_n\otimes\ket y_n \rightarrow \ket x_n\otimes\ket{y\oplus f(x)}_n $$
Используются два регистра по $n$ кубит каждый; первый назовём *регистром данных*, второй — *регистром результата*. Оба регистра изначально в нулевом состоянии. Вместе они образуют объединённый начальный регистр:

$$ \ket{\phi_0}_{2n}=\ket0_n\otimes\ket0_n. $$

На регистр данных подействуем оператором Уолша — Адамара, получаем состояние

$$ \ket{\phi_1}_{2n} \equiv W^{(n)}\otimes I^{(n)}:\ket{\phi_0}_{2n}={1\over\sqrt{2^n}}\sum_{x=0}^{2^n-1}\ket x_n\otimes\ket0_n. $$
Здесь $I^{(n)}$ — единичный оператор. Далее действуем унитарным оператором $\hat{\text{U}}_f$:

$$ \ket{\phi_2}_{2n}\equiv\hat{\text{U}}_f:\ket{\phi_1}_{2n}={1\over\sqrt{2^n}}\sum_{x=0}^{2^n-1}\ket x_n\otimes\ket{f(x)}_n. $$

Затем действуем гейтом Уолша — Адамара для возникновения квантовой интерференции регистра данных и регистра результата.

$$ \ket{\phi_3}_{2n} = W^{(n)}\otimes I^{(n)}:\ket{\phi_2}_{2n}={1\over2^n}\sum_{x'=0}^{2^n-1}\sum_{x=0}^{2^n-1}(-1)^{x'x}\ket{x'}_n\otimes\ket{f(x)}_n $$

Алгоритм предполагает повторение процедуры, указанной на схеме, и измерение регистра данных $\ket{x'}$ несколько раз с записью результата измерения $x' \rightarrow (x_0,x_1,\ldots,x_{n-1})$.

## Пояснение смысла

Перепишем $\ket{\phi_2}$ с учётом периода $f(x)$:

$$ \ket{\phi_2}_{2n}\equiv\hat{\text{U}}_f:\ket{\phi_1}_{2n}={1\over\sqrt{2^n}}\sum_{x=0}^{2^n-1}\ket{x\oplus r}_n\otimes\ket{f(x\oplus r)}_n. $$

Сложим это с исходным выражением для $\ket{\phi_2}$ и поделим на 2:

$$ \ket{\phi_2}_{2n}={1\over\sqrt{2^n}}\sum_{x=0}^{2^n-1}\frac{\ket x_n+\ket{x\oplus r}_n}2\otimes\ket{f(x)}_n $$

![[Pasted image 20250618041937.png]]

![[Pasted image 20250618042000.png]]

![[Pasted image 20250618042603.png]]

# Классическая часть

Классическая часть заключается в решении системы уравнений (6.37) классическими (не квантовыми) методами. Её решение позволяет найти бинарное представление периода $r$ функции $f(x)$.

# Пример с двумя кубитами

Пусть регистры данных и результата являются двухкубитовыми, тогда имеем четыре базисных состояния: $\ket{00},\ket{01},\ket{10},\ket{11}$ и четыре соответствующих значения функции $f$. Выпишем явный вид состояния $\ket{\phi_3}$ в таком случае:

$$
\begin{eqnarray}
\ket{\phi_3}_4&=&{1\over4}[\ket0+\ket1+\ket2+\ket3]\otimes\ket{f(0)}+\\
&+&{1\over4}[\ket0-\ket1+\ket2-\ket3]\otimes\ket{f(1)}+\\
&+&{1\over4}[\ket0+\ket1-\ket2-\ket3]\otimes\ket{f(2)}+\\
&+&{1\over4}[\ket0-\ket1-\ket2+\ket3]\otimes\ket{f(3)}.\\
\end{eqnarray}
$$

Если функция имеет двоичный период $r=2$, то равенство можно переписать в следующем виде:

$$
\begin{eqnarray}
\ket{\phi_3}_4&=&{1\over2}[\ket0+\ket1]\otimes\ket{f(0)}+{1\over2}[\ket0-\ket1]\otimes\ket{f(1)}=\\
&=&\ket0\otimes\frac{\ket{f(0)}+\ket{f(1)}}2+\ket1\otimes\frac{\ket{f(0)}-\ket{f(1)}}2
\end{eqnarray}
$$

В итоге при измерении может выйти либо состояние $\ket{00}$, либо состояние $\ket{01}$. При выполнении алгоритма как минимум два раза получим векторы $z_1=(0,0)$ и $z_2=(0,1)$. Для всех $z_i$ должно выполняться $rz_i=0$. Нетривиальным решением такой системы уравнений является только вектор $r=(1,0)$, то есть период функции $r=10_2=2_{10}$.
